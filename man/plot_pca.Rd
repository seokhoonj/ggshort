% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pca.R
\name{plot_pca}
\alias{plot_pca}
\title{PCA plot}
\usage{
plot_pca(
  data,
  measure_vars,
  color_var,
  x = 1,
  y = 2,
  scale = 1,
  alpha = 0.3,
  show_arrow = TRUE,
  show_label = TRUE,
  label_args = list(family = getOption("ggshort.font"), size = 4, angle = 0, hjust = 0.5,
    vjust = 0.5, color = "black"),
  show_mean = TRUE,
  show_median = TRUE,
  show_ellipse = TRUE,
  show_chull = FALSE,
  show_density = FALSE,
  palette = "Set1",
  title = NULL,
  subtitle = NULL,
  caption = NULL,
  theme = c("view", "save", "shiny"),
  ...
)
}
\arguments{
\item{data}{A data.frame containing the variables to be analyzed with PCA.}

\item{measure_vars}{Columns to use for PCA. Supports:
\itemize{
\item unquoted selection, e.g. \code{c(x1, x2, x3)} or \code{.(x1, x2, x3)},
\item a character vector of names, e.g. \code{c("x1","x2","x3")},
\item or integer indices, e.g. \code{c(1,2,3)}.
If missing, \strong{all numeric columns} in \code{data} are used. At least two
numeric columns are required.
}}

\item{color_var}{Optional single column used to color points. Supports the
same forms as \code{measure_vars} but must resolve to \strong{exactly one} column.}

\item{x, y}{Principal component indices for the x- and y-axes (defaults:
\code{x = 1}, \code{y = 2}). They must be different and within the number of PCs.}

\item{scale}{Scaling exponent applied to score axes; set \code{0} to disable.
Internally the scores on PCs \code{x} and \code{y} are divided by \code{sdev * sqrt(n)}
and then raised to \code{scale} (biplot-like scaling). Default: \code{1}.}

\item{alpha}{Point transparency in [0, 1]. Default: \code{0.3}.}

\item{show_arrow}{Logical; if \code{TRUE}, draw loading arrows. Default: \code{TRUE}.}

\item{show_label}{Logical; if \code{TRUE}, draw variable names at arrow tips.
Default: \code{TRUE}.}

\item{label_args}{A named list of text styling options for loading labels
(\code{geom_text()}): \code{family}, \code{size}, \code{angle}, \code{hjust}, \code{vjust}, \code{color}.
Default:
\code{list(family = getOption("ggshort.font"), size = 4, angle = 0, hjust = 0.5, vjust = 0.5, color = "gray7")}.}

\item{show_mean}{Logical; if \code{TRUE} and \code{color_var} is categorical, add group
mean points (shape: O). Ignored for numeric \code{color_var}. Default \code{FALSE}.}

\item{show_median}{Logical; if \code{TRUE} and \code{color_var} is categorical, add group
median points (shape: X). Ignored for numeric \code{color_var}. Default \code{FALSE}.}

\item{show_ellipse}{Logical; if \code{TRUE} and \code{color_var} is provided, draw
normal-theory ellipses by group at 0.90 level. Default: \code{TRUE}.}

\item{show_chull}{Logical; if \code{TRUE} and \code{color_var} is categorical,
draw per-group convex hull outlines (via \code{\link[=stat_chull]{stat_chull()}}).
Default: \code{FALSE}.}

\item{show_density}{Logical; if \code{TRUE} and \code{color_var} is categorical, attach
marginal density panels (top/right) colored by group. Default \code{TRUE}.}

\item{palette}{Discrete palette name for categorical \code{color_var}, forwarded to
\code{\link[ggplot2:scale_brewer]{ggplot2::scale_color_brewer()}} and \code{\link[ggplot2:scale_brewer]{ggplot2::scale_fill_brewer()}}.
Default \code{"Set1"}. Ignored when \code{color_var} is numeric.}

\item{title, subtitle, caption}{Plot title, subtitle, and caption. Passed to
\code{\link[ggplot2:labs]{ggplot2::labs()}}.}

\item{theme}{A ggshort theme key passed to \code{\link[=switch_theme]{switch_theme()}}: one of
\code{"view"}, \code{"save"}, or \code{"shiny"}.}

\item{...}{Additional arguments forwarded to \code{switch_theme(theme = ...)}.}
}
\value{
A ggplot object.
}
\description{
Draw a PCA biplot-like figure from a data frame. The function computes
\code{\link[stats:prcomp]{stats::prcomp()}} on selected numeric columns (\code{measure_vars}), plots scores
on the requested principal components, and overlays loading (variable) arrows.
}
\details{
\itemize{
\item \strong{Selection helpers:} \code{measure_vars}/\code{color_var} are resolved via
\code{capture_names()}, so \code{c(a,b)}, \code{.(a,b)}, character names, and indices
are all supported.
\item \strong{Coloring logic:} If \code{color_var} is categorical (factor/character/logical),
a discrete Brewer palette (\code{palette}) is applied to points and densities.
If \code{color_var} is numeric, a continuous gradient (blue -> red) is used and
\code{show_mean}/\code{show_ellipse}/\code{show_density} are ignored.
\item \strong{Scaling:} With \code{scale != 0}, scores on the chosen PCs are divided by
\code{sdev * sqrt(n)} and raised to \code{scale} to approximate classic biplot scaling.
\item \strong{Arrows/labels:} Loading vectors are scaled to fit within the score range.
Labels are styled via \code{label_args}.
}
}
\examples{
\donttest{
# Quick start: use all numeric columns (Species excluded automatically)
plot_pca(iris, x = 1, y = 2)

# Explicit variables (character) + categorical coloring with ellipses & means
plot_pca(
  iris,
  measure_vars = c("Sepal.Length", "Sepal.Width", "Petal.Length", "Petal.Width"),
  color_var = "Species",
  x = 1, y = 2,
  show_ellipse = TRUE,
  show_mean = TRUE,
  palette = "Set2",
  title = "Iris PCA (categorical coloring)"
)

# NSE selection (unquoted)
plot_pca(
  iris,
  measure_vars = c(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width),
  color_var = Species
)

# Integer indices
plot_pca(iris, measure_vars = 1:4, color_var = 5)

# Numeric color variable -> continuous gradient; ellipses/means/density off
df <- iris
df$num_group <- df$Sepal.Length
plot_pca(df, measure_vars = 1:4, color_var = num_group)
}

}
